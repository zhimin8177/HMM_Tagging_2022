人工智能 在 拾取 地震 P 波 初 至 中 的 应用 — — 以 汶 川 地震 余震 序列 为 例 
蔡振宇 盖 增 喜 （ 北京大学 地球 与 空间 科学 学院 ， 北京 100871 ； 通信 作者 ， E - mail : zge @ pku . edu . cn ） 
摘要 ： 为了 准确 而 迅速 地 拾取 大量 地震 事件 的 P 波 初 至 ， 将 深度 学习 方法 引入 微 地震 P 波 初 至 到时 拾取 研究 中 ， 对 卷 积 神经 网络 的 结构 进行 改造 ， 以便 适应 地震 波形 数据 的 特点 和 P 波 初 至 拾取 的 要求 。 该 算法 只 需要 输入 10 s 窗口 的 三 分量 地震 波形 数据 ， 就 可以 自动 地 判定 P 波 初 至 时刻 ， 无需 扫描 连续 波形 ， 运算 时间 远远 小于 长短 窗 、 模板 匹配 等 传统 方法 。 使用 该 算法 训练 汶 川 地震 主 震 后 2008 年 7 — 8 月 7467 条 人工 拾取 的 余震 P 波 初 至 到时 ， 将 得到 的 模型 对 测试 集中 1867 条 数据 的 计算 结果 与 人工 拾取 结果 对比 ， 误差 小于 0 . 5 s 者 占 比 达到 98 . 9 % 。 在 低 信 噪 比 条件 下 ， 该 方法 仍 能 保持 较 好 的 拾取 能力 。 
关键词 ： 人工智能 ； 机器 学习 ； 深度 学习 ； 小 波 变换 ； 初 至 拾取 
汶 川 地震 主 震 发生 后 ， 不断 地 有 余震 发生 。 为了 更 好 地 开展 抗震救灾 工作 ， 需要 更 快速 和 精 准 的 手段 来 识别 余震 的 初 至 时刻 并 构建 余震 地震 目录 。 如果 能够 自动 地 识别 这些 微弱 的 地震 信号 和 遗漏 的 早期 余震 ， 找到 余震 震 相 的 初 至 时刻 ， 将 对 完善 地震 目录 、 地震 预警 、 全面 分析 地震 活动性 以及 监测 地震 破裂 区域 的 震 后 形变 等 具有 重要 意义 。 地震 震 相 到时 拾取 是 地震学 研究 的 重要 课题 ， 是 地震 预警 、 地震 定位 及 地球 内部 结构 等 研究 的 基础 。 地震 预警 技术 是 近 二 十年 发展 起来 的 一种 减轻 地震 损失 、 减少 人员 伤亡 、 降低 地震 次生 灾害 的 有效 手段 。 通常 情况 下 ， 由于 地震 P 波 波 速 大于 破坏性 较 大 的 S 波 和面 波 ， 且 地震波 速度 远远 小于 电磁波 速度 ， 因此 地震 预警 系统 可 在 破坏性 地震 发生 后 ， 基于 近 震源 地区 地震 台站 监测 记录 得到 的 地震 波形 数据 ， 快速 地 侦测 地震 ， 在 破坏性 地震波 到达 特定 目标 区 前 ， 发布 地震 警报 。 
从 技术 层面 上 看 ， 地震 震 相 的 自动 拾取 是 实现 基于 地震 台网 地震 预警 的 首要 条件 。 在 传统 地震学 中 ， 一般 是 在 地震 图上 人工 拾取 震 相 。 震 相 的 自动 识别 开始 于 对 海量 波形 数据 的 自动 处理 ， 随着 实时 地震学 的 发展 ， 对 震 相 的 自动 精确 拾取 受到 越来越 多 的 重视 。 对 地震 预警 而 言 ， 目前 主要 考虑 的 震 相 为 容易 自动 拾取 的 P 波 震 相 和 S 波 震 相 。 在 各种 地震 震 相 自动 拾取 方法 中 ， 广泛 应用 的 主要 有 两 种 ， 一种 是 反映 幅 值 瞬时 变化 的 长短 时 窗 比 方法 ， 另 一种 是 基于 互相 关 技术 的 模板 匹配 滤波 方法 。 这 两 种 方法 或者 依赖 于 阈 值 的 设定 ， 或者 依赖 于 模板 的 选取 ， 在 一定 程度 上 限制 了 应用 范围 。 人工智能 领域 中 近年来 广泛 使用 的 神经 网络 模型 可以 根据 输入 的 训练 数据 训练 参数 ， 而 不用 人工 设定 参数 ， 可能 更 适用 于 不同 地区 不同 性质 的 微 地震 震 相 到时 拾取 ， 特别 是 在 信 噪 比较 低 的 情形 下 。 
长短 时 窗 比 ( STA  LTA ) 方法 由 Stevenson 提出 ， Earle 等 完善 了 该 方法 ， 并且 将 其 应用 于 地震 研究 中 。 该 方法 利用 有效 信号 与 噪声 的 振 幅 差异 ， 通过 两 个 长度 不同 的 滑动 时 窗 来 判断 初 至 时刻 ， 目前 广泛 应用 于以微 地震 为 代表 的 初 至 拾取 研究 中 。 其中 ， 短 时 窗 用于 截取 微弱 的 有用 信号 ， 长 时 窗内 信号 的 平均值 则 反映 背景 噪声 水平 ， 包 络 线上 短 时 窗内 信号 的 平均值 与 长 时 窗内 信号 平均值 的 比值 用来 表征 信号 振 幅 的 变化 。 与 其他 震 相 拾取 方法 相比 ， 该 方法 具有 算法 简单 、 计算 速度 快 的 特点 ， 对 不同 的 震 相 均可 拾取 。 但是 ， 该 方法 依赖 于 阈 值 的 选取 ， 对于 特定 的 情形 ， 需要 人工 设定 阈 值 ； 另一方面 ， 长短 时 窗 比 方法 对 信 噪 比 的 要求 较 高 ， 对 信 噪 比较 低 的 微 地震 拾取 效果 欠佳 。 
模板 匹配 滤波 技术 是 在 滑动 窗 互相 关 检测 技术 的 基础上 发展 起来 的 ， 通过 扫描 连续 波形 来 自动 拾取 震 相 ， 是 在 信 噪 比较 低 的 情况 下 提取 微弱 信号 的 一种 有效 方法 。 该 方法 将 现有 地震 目录 中 记录 的 事件 作为 模板 ， 扫描 连续 波形 ， 从中 识别 出 与 模板 事件 波形 有 一定 相似 度 的 地震 事件 。 与 长短 时 窗 比 方法 相比 ， 该 方法 具有 在 信 噪 比较 低 情况 下 仍 适用 的 优点 。 然而 ， 该 方法 也 有 其 局限性 ， 一方面 检测 出 地震 的 数目 依赖 于 所 选取 的 模板 数目 ， 另一方面 ， 只能 识别 重复 的 地震 信号 。 与 长短 窗 比 方法 类似 ， 该 方法 也 需要 设定 互相 关系 数 的 阈 值 。 近年来 的 新 方法 主要 围绕 这 两 种 方法 进行 改进 和 优化 ， 选取 不同 的 特征 函数 来 计算 长短 时 窗 比 ， 如 Zhang 等 2017 年 将 分 形 引入 长短 时 窗 比 方法 中 。 但是 ， 这些 改进 不能 从 本质上 解决 阈 值 的 人工 设定 以及 低 信 噪 比 情形 下 效果 差 的 问题 。 
以上 两 类 方法 需要 扫描 连续 波形 ， 存在 运行 速度 慢 的 特点 。 如果 能够 将 连续 数据 切割 成 相互 独立 的 窗口 作为 输入 ， 将 大大 减少 运算 时间 。 此外 ， 长短 窗 比 方法 中 的 特征 函数 和 阈 值 参数 均 需要 人工 选取 ， 若 能 避开 人工 的 局限 ， 直接 从 数据 中 挖掘 出 特征 和 参数 ， 将 大大 简化 初 至 拾取 的 流程 。 
随着 大 数据 时代 的 来临 ， 人工智能 领域 取得 飞速 的 发展 ， 一方面 数据量 呈 指数 式 增长 ， 另一方面 计算机 硬件 计算 能力 不断 提升 ， 特别 是 随着 GPU 广泛 应用 于 深度 学习 计算 中 ， 过去 应用 范围 受 局限 的 深度 学习 方法 开始 应用 到 各个 领域 中 。 深度 学习 方法 具有 结构 更 复杂 、 可 训练 参数 更多 以及 无需 人工 选取 特征 等 优点 ， 在 众多 领域 逐渐 超越 传统 机器 学习 方法 ， 得到 更 广泛 的 应用 。 
人工智能 在 地震学 领域 的 应用 目前 处于 起步 阶段 。 过去 几 十年 来 ， 随着 宽频 带 地震 仪 的 普及 ， 地震 数据 的 质 和 量 都 得到 大幅度 的 提升 ， 为 人工智能 方法 在 地震学 领域 的 应用 提供 了 数据量 方面 的 支持 。 地震波 和 声波 同属 机械 波 ， 地震波 数据 与 声波 数据 也 有 一些 共同 的 特性 ， 这 为 将 人工智能 语音 识别 的 一些 方法 拓展 到 对 地震波 数据 的 分析 处理 中 提供 了 可能性 。 人工 神经 网络 模型 的 雏形 在 20 世纪 40 年代 就 已 提出 ， 20 世纪 90 年代 就 有人 试图 将 其 应用 于震相 的 识别 中 ， 但 由于 当时 数据量 和 计算 能力 等 多方面 的 限制 ， 没 能 取得 好 的 效果 。 
鉴于 上述 背景 ， 本文 另辟蹊径 ， 绕开 上述 两 类 方法 的 窠臼 ， 将 人工智能 领域 的 卷 积 神经 网络结构 引入 地震波 P 波 初 至 时刻 拾取 中 ， 并 根据 地震波 波形 数据 的 特性 和 P 波 初 至 拾取 问题 的 特殊性 ， 对 传统 的 卷 积 神经 网络结构 进行 一定 程度 的 调整 ， 充分 利用 深度 学习 方法 在 大 数据量 情形 下 的 优势 。 我们 将 P 波 初 至 时刻 拾取 问题 转化 为 一个 监督 学习 中 的 回归 问题 ， 通过 对 大量 已经 标记 好 到时 的 连续 波形 数据 进行 训练 ， 使 机器 学习 得到 一个 可以 重复 使用 的 卷 积 神经 网络 模型 。 该 模型 一旦 训练 结束 ， 在 实时 拾取 P 波 初 至 时 ， 只 需要 将 连续 波形 数据 切割 成 10 s 的 数据 段 作为 输入 ， 即可 迅速 得到 拾取 到时 结果 ， 无须 对 原始 波形 进行 逐 点 扫描 ， 大大 节省 运行 时间 。 此外 ， 在 模型 的 训练 过程 中 ， 利用 GPU 加速 ， 使得 训练 时间 也 大大 缩短 。 以 本文 具体 使用 的 模型 为 例 ， 从 输入 数据 到 训练 出 最终 模型 只 需要 4 ~ 5 小时 。 与 长短 时 窗 比 方法 相比 ， 该 模型 的 构建 既 不 需要 人工 选取 振 幅 或 能量 等 具有 实际 物理 意义 的 特征 函数 ， 也 不 需要 选取 阈 值 。 该 方法 也 不 需要 选取 模板 ， 而是 直接 输入 三 分量 连续 波形 数据 ， 输入 数据 被 简单 地 归 一 化 后 ， 即可 通过 训练 好 的 模型 得到 拾取 的 到时 时刻 。 在 训练 的 过程 中 ， 卷 积 神经 网络 通过 一系列 滤波器 实现 参数 最 优化 ， 从而 从 波形 数据 中 找到 识别 初 至 的 特征 ， 这 一切 都是 机器 通过 训练 习得 的 ， 不 需要 人工 挑选 特征 或 模板 。 
1 数据 分析 与 预 处理 
根据 中国 地震 台网 中心 的 统计 ， 汶 川 地震 主 震 发生 后 ， 2018 年 5 月 共有 6 . 0 级 以上 余震 5 次 ， 5 . 0 ~ 5 . 9 级 余震 25 次 ， 4 . 0 ~ 4 . 9 级 余震 161 次 ； 6 月 共有 6 . 0 级 以上 余震 0 次 ， 5 . 0 ~ 5 . 9 级 余震 3 次 ， 4 . 0 ~ 4 . 9 级 余震 31 次 ； 7 月 共有 6 . 0 级 以上 余震 1 次 ， 5 . 0 ~ 5 . 9 级 余震 2 次 ， 4 . 0 ~ 4 . 9 级 余震 15 次 。 当 震源 周边 的 地震 台站 监测 到 这些 余震 信号 时 ， 通过 提取 P 波 和 S 波 的 初 至 时刻 ， 可以 确定 余震 的 震中 位置 ， 为 抗震救灾 工作 提供 重要 信息 。 然而 ， 在 现实 情况 中 ， 由于 受到 背景 噪声 水平 、 记录 仪器 分布 等 多种 因素 的 影响 ， 许多 微弱 的 地震 信号 被 淹没 在 噪声 中 ， 无法 直接 观测 到 。 另一方面 ， 在 大 地震 发生 后 的 短 时间 内 ， 由于 强震 尾 波 的 影响 以及 大量 余震 事件 的 发生 ， 波形 相互 重叠 ， 难以 区分 。 
本文 采用 汶 川 地震 后 ( 2008 年 7 月 1 — 31 日 ) 四川 及 邻省 16 个 地震 台站 的 三 分量 连续 波形 数据 ， 由 国家 数字 测 震 台网 数据 备份 中心 提供 。 
本文 将 三 分量 连续 原始 波形 分割 成 时间 窗口 长度 为 10 s 的 片段 ， 数据 原始 采样 率 为 100 Hz ， 故 数据 格式 为 1000 × 3 的 二 维 矩阵 。 对 每 段 数据 进行 1 Hz 高通 滤波 ， 滤掉 长 周期 背景 波动 。 然后 ， 对 每 段 数据 的 每 一道 分量 单独 进行 归 一 化 操作 ， 即将 数据 除 以 整 段 数据 幅 值 绝对值 的 最大 值 ， 使 其 最大 值 的 绝对值 为 1 。 本文 采用 人工 标记 好 P 波 到时 的 三 分量 数据 9334 条 ， 从中 随机 抽取 数据 分为 训练 集 、 验证 集 和 测试 集 。 其中 ， 5974 条 ( 64 % ) 作为 训练 集 ， 用于 训练 模型 参数 ； 1493 条 ( 16 % ) 作为 验证 集 ， 用于 判断 训练 停止 时刻 ； 1867 条 ( 20 % ) 作为 测试 集 ， 用于 证 模型 样本 外 的 泛 化 能力 ， 各样 本 集 之间 数据量 的 比例 按照 惯例 [ 9 ] ， 测试 集 与 训练 集 和 验证 集 之 和 的 比例 以及 验证 集 与 训练 集 的 比例 均 取 1 : 4 。 